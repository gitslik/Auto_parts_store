function doLiveSearch(e,n){return 38==e.keyCode||40==e.keyCode?!1:($("#livesearch_search_results").remove(),updown=-1,""==n||n.length<3?!1:(n=encodeURI(n),$.ajax({url:$("base").attr("href")+"index.php?route=product/search/ajax&keyword="+n,dataType:"json",content:this,success:function(e){if(e.length>0){var d=document.createElement("ul");d.id="livesearch_search_results";var o,t,r;for(var i in e)o=document.createElement("li"),r=document.createElement("a"),$(function(){t=document.createElement("img"),t.className="loading",$(t).load(function(){$(this).show()}),t.src=e[i].image,r.appendChild(t)}),r.appendChild(document.createTextNode(e[i].name)),r.href="undefined"!=typeof e[i].href?e[i].href:$("base").attr("href")+"index.php?route=product/product&product_id="+e[i].product_id+"&keyword="+n,o.appendChild(r),d.appendChild(o);$("#livesearch_search_results").length>0&&$("#livesearch_search_results").remove(),$("#search").append(d)}}}),!0))}function upDownEvent(e){{var n=document.getElementById("livesearch_search_results");$("#search").find("[name=search]").first()}if(n){var d=n.childNodes.length-1;if(-1!=updown&&"undefined"!=typeof n.childNodes[updown]&&$(n.childNodes[updown]).removeClass("highlighted"),38==e.keyCode?updown=updown>0?--updown:updown:40==e.keyCode&&(updown=d>updown?++updown:updown),updown>=0&&d>=updown){$(n.childNodes[updown]).addClass("highlighted");var o=n.childNodes[updown].childNodes[0].text;"undefined"==typeof o&&(o=n.childNodes[updown].childNodes[0].innerText),$("#search").find("[name=search]").first().val(new String(o).replace(/(\s\(.*?\))$/,""))}}return!1}var updown=-1;$(document).ready(function(){$("#search").find("[name=search]").first().keyup(function(e){doLiveSearch(e,this.value)}).focus(function(e){doLiveSearch(e,this.value)}).keydown(function(e){upDownEvent(e)}).blur(function(){window.setTimeout("$('#livesearch_search_results').remove();updown=0;",600)}),$(document).bind("keydown",function(e){try{13==e.keyCode&&$(".highlighted").length>0&&(document.location.href=$(".highlighted").find("a").first().attr("href"))}catch(n){}})});